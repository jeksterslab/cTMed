<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Fit the Continuous-Time Vector Autoregressive Model Using the dynr Package • cTMed</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Roboto-0.4.9/font.css" rel="stylesheet">
<link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet">
<link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit the Continuous-Time Vector Autoregressive Model Using the dynr Package">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">cTMed</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/cTMed.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="nav-link" href="https://github.com/jeksterslab/cTMed/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fit the Continuous-Time Vector Autoregressive Model Using the dynr Package</h1>
                        <h4 data-toc-skip class="author">Ivan Jacob
Agaloos Pesigan</h4>
            
            <h4 data-toc-skip class="date">2025-02-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jeksterslab/cTMed/blob/main/vignettes/fit-ct-var-dynr.Rmd"><code>vignettes/fit-ct-var-dynr.Rmd</code></a></small>
      <div class="d-none name"><code>fit-ct-var-dynr.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="data-generation-using-the-simssmoufixed-function-from-the-simstatespace-package">Data Generation Using the <code>SimSSMOUFixed</code> Function from
the <code>simStateSpace</code> Package<a class="anchor" aria-label="anchor" href="#data-generation-using-the-simssmoufixed-function-from-the-simstatespace-package"></a>
</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="va">time</span></span>
<span><span class="co">#&gt; [1] 100</span></span>
<span><span class="va">delta_t</span></span>
<span><span class="co">#&gt; [1] 0.1</span></span>
<span><span class="va">mu0</span></span>
<span><span class="co">#&gt; [1] 0 0 0</span></span>
<span><span class="va">sigma0</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt; [1,]  1.0  0.2  0.2</span></span>
<span><span class="co">#&gt; [2,]  0.2  1.0  0.2</span></span>
<span><span class="co">#&gt; [3,]  0.2  0.2  1.0</span></span>
<span><span class="va">sigma0_l</span> <span class="co"># sigma0_l &lt;- t(chol(sigma0))</span></span>
<span><span class="co">#&gt;      [,1]      [,2]      [,3]</span></span>
<span><span class="co">#&gt; [1,]  1.0 0.0000000 0.0000000</span></span>
<span><span class="co">#&gt; [2,]  0.2 0.9797959 0.0000000</span></span>
<span><span class="co">#&gt; [3,]  0.2 0.1632993 0.9660918</span></span>
<span><span class="va">mu</span></span>
<span><span class="co">#&gt; [1] 0 0 0</span></span>
<span><span class="va">phi</span></span>
<span><span class="co">#&gt;        [,1]   [,2]   [,3]</span></span>
<span><span class="co">#&gt; [1,] -0.357  0.000  0.000</span></span>
<span><span class="co">#&gt; [2,]  0.771 -0.511  0.000</span></span>
<span><span class="co">#&gt; [3,] -0.450  0.729 -0.693</span></span>
<span><span class="va">sigma</span></span>
<span><span class="co">#&gt;             [,1]       [,2]        [,3]</span></span>
<span><span class="co">#&gt; [1,]  0.24455556 0.02201587 -0.05004762</span></span>
<span><span class="co">#&gt; [2,]  0.02201587 0.07067800  0.01539456</span></span>
<span><span class="co">#&gt; [3,] -0.05004762 0.01539456  0.07553061</span></span>
<span><span class="va">sigma_l</span> <span class="co"># sigma_l &lt;- t(chol(sigma))</span></span>
<span><span class="co">#&gt;             [,1]      [,2]     [,3]</span></span>
<span><span class="co">#&gt; [1,]  0.49452559 0.0000000 0.000000</span></span>
<span><span class="co">#&gt; [2,]  0.04451917 0.2620993 0.000000</span></span>
<span><span class="co">#&gt; [3,] -0.10120330 0.0759256 0.243975</span></span>
<span><span class="va">nu</span></span>
<span><span class="co">#&gt; [1] 0 0 0</span></span>
<span><span class="va">lambda</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt; [1,]    1    0    0</span></span>
<span><span class="co">#&gt; [2,]    0    1    0</span></span>
<span><span class="co">#&gt; [3,]    0    0    1</span></span>
<span><span class="va">theta</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt; [1,]  0.2  0.0  0.0</span></span>
<span><span class="co">#&gt; [2,]  0.0  0.2  0.0</span></span>
<span><span class="co">#&gt; [3,]  0.0  0.0  0.2</span></span>
<span><span class="va">theta_l</span> <span class="co"># theta_l &lt;- t(chol(theta))</span></span>
<span><span class="co">#&gt;           [,1]      [,2]      [,3]</span></span>
<span><span class="co">#&gt; [1,] 0.4472136 0.0000000 0.0000000</span></span>
<span><span class="co">#&gt; [2,] 0.0000000 0.4472136 0.0000000</span></span>
<span><span class="co">#&gt; [3,] 0.0000000 0.0000000 0.4472136</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jeksterslab/simStateSpace" class="external-link">simStateSpace</a></span><span class="op">)</span></span>
<span><span class="va">sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://github.com/jeksterslab/simStateSpace/reference/SimSSMOUFixed.html" class="external-link">SimSSMOUFixed</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="va">n</span>,</span>
<span>  time <span class="op">=</span> <span class="va">time</span>,</span>
<span>  delta_t <span class="op">=</span> <span class="va">delta_t</span>,</span>
<span>  mu0 <span class="op">=</span> <span class="va">mu0</span>,</span>
<span>  sigma0_l <span class="op">=</span> <span class="va">sigma0_l</span>,</span>
<span>  mu <span class="op">=</span> <span class="va">mu</span>,</span>
<span>  phi <span class="op">=</span> <span class="va">phi</span>,</span>
<span>  sigma_l <span class="op">=</span> <span class="va">sigma_l</span>,</span>
<span>  nu <span class="op">=</span> <span class="va">nu</span>,</span>
<span>  lambda <span class="op">=</span> <span class="va">lambda</span>,</span>
<span>  theta_l <span class="op">=</span> <span class="va">theta_l</span>,</span>
<span>  type <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">sim</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"time"</span>, <span class="st">"x"</span>, <span class="st">"m"</span>, <span class="st">"y"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span><span class="co">#&gt;   id time          x          m        y</span></span>
<span><span class="co">#&gt; 1  1  0.0 -0.3504435 0.41877429 2.611996</span></span>
<span><span class="co">#&gt; 2  1  0.1 -0.5920330 1.07433208 1.669272</span></span>
<span><span class="co">#&gt; 3  1  0.2 -0.7619855 1.21483834 2.369837</span></span>
<span><span class="co">#&gt; 4  1  0.3 -1.6964652 0.21209722 2.128531</span></span>
<span><span class="co">#&gt; 5  1  0.4 -1.2282686 0.09950326 1.891140</span></span>
<span><span class="co">#&gt; 6  1  0.5  0.1433985 0.66784226 2.036033</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="model-fitting">Model Fitting<a class="anchor" aria-label="anchor" href="#model-fitting"></a>
</h2>
<p>We use the <code>dynr</code> package to fit the continuous-time
vector autoregressive model.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dynrr.github.io/" class="external-link">dynr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="prepare-the-data">Prepare the Data<a class="anchor" aria-label="anchor" href="#prepare-the-data"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dynr_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dynr/man/dynr.data.html" class="external-link">dynr.data</a></span><span class="op">(</span></span>
<span>  dataframe <span class="op">=</span> <span class="va">data</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>  time <span class="op">=</span> <span class="st">"time"</span>,</span>
<span>  observed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"m"</span>, <span class="st">"y"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="prepare-the-initial-condition">Prepare the Initial Condition<a class="anchor" aria-label="anchor" href="#prepare-the-initial-condition"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dynr_initial</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dynr/man/prep.initial.html" class="external-link">prep.initial</a></span><span class="op">(</span></span>
<span>  values.inistate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span></span>
<span>  <span class="op">)</span>,</span>
<span>  params.inistate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"mu0_1_1"</span>, <span class="st">"mu0_2_1"</span>, <span class="st">"mu0_3_1"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  values.inicov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="fl">1.0</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>,</span>
<span>      <span class="fl">0.2</span>, <span class="fl">1.0</span>, <span class="fl">0.2</span>,</span>
<span>      <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">1.0</span></span>
<span>    <span class="op">)</span>,</span>
<span>    nrow <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span>,</span>
<span>  params.inicov <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"sigma0_1_1"</span>, <span class="st">"sigma0_2_1"</span>, <span class="st">"sigma0_3_1"</span>,</span>
<span>      <span class="st">"sigma0_2_1"</span>, <span class="st">"sigma0_2_2"</span>, <span class="st">"sigma0_3_2"</span>,</span>
<span>      <span class="st">"sigma0_3_1"</span>, <span class="st">"sigma0_3_2"</span>, <span class="st">"sigma0_3_3"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    nrow <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="prepare-the-measurement-model">Prepare the Measurement Model<a class="anchor" aria-label="anchor" href="#prepare-the-measurement-model"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dynr_measurement</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dynr/man/prep.measurement.html" class="external-link">prep.measurement</a></span><span class="op">(</span></span>
<span>  values.load <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/dynr/man/diag-character-method.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>  params.load <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="st">"fixed"</span>,</span>
<span>    nrow <span class="op">=</span> <span class="fl">3</span>,</span>
<span>    ncol <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span>,</span>
<span>  state.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"eta_x"</span>, <span class="st">"eta_m"</span>, <span class="st">"eta_y"</span><span class="op">)</span>,</span>
<span>  obs.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"m"</span>, <span class="st">"y"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="prepare-the-dynamic-model">Prepare the Dynamic Model<a class="anchor" aria-label="anchor" href="#prepare-the-dynamic-model"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dynr_dynamics</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dynr/man/prep.formulaDynamics.html" class="external-link">prep.formulaDynamics</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="va">eta_x</span> <span class="op">~</span> <span class="va">phi_1_1</span> <span class="op">*</span> <span class="va">eta_x</span> <span class="op">+</span> <span class="va">phi_1_2</span> <span class="op">*</span> <span class="va">eta_m</span> <span class="op">+</span> <span class="va">phi_1_3</span> <span class="op">*</span> <span class="va">eta_y</span>,</span>
<span>    <span class="va">eta_m</span> <span class="op">~</span> <span class="va">phi_2_1</span> <span class="op">*</span> <span class="va">eta_x</span> <span class="op">+</span> <span class="va">phi_2_2</span> <span class="op">*</span> <span class="va">eta_m</span> <span class="op">+</span> <span class="va">phi_2_3</span> <span class="op">*</span> <span class="va">eta_y</span>,</span>
<span>    <span class="va">eta_y</span> <span class="op">~</span> <span class="va">phi_3_1</span> <span class="op">*</span> <span class="va">eta_x</span> <span class="op">+</span> <span class="va">phi_3_2</span> <span class="op">*</span> <span class="va">eta_m</span> <span class="op">+</span> <span class="va">phi_3_3</span> <span class="op">*</span> <span class="va">eta_y</span></span>
<span>  <span class="op">)</span>,</span>
<span>  startval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    phi_1_1 <span class="op">=</span> <span class="op">-</span><span class="fl">0.2</span>, phi_2_1 <span class="op">=</span> <span class="fl">0.0</span>, phi_3_1 <span class="op">=</span> <span class="fl">0.0</span>,</span>
<span>    phi_1_2 <span class="op">=</span> <span class="fl">0.0</span>, phi_2_2 <span class="op">=</span> <span class="op">-</span><span class="fl">0.2</span>, phi_3_2 <span class="op">=</span> <span class="fl">0.0</span>,</span>
<span>    phi_1_3 <span class="op">=</span> <span class="fl">0.0</span>, phi_2_3 <span class="op">=</span> <span class="fl">0.0</span>, phi_3_3 <span class="op">=</span> <span class="op">-</span><span class="fl">0.2</span></span>
<span>  <span class="op">)</span>,</span>
<span>  isContinuousTime <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="prepare-the-noise-matrices">Prepare the Noise Matrices<a class="anchor" aria-label="anchor" href="#prepare-the-noise-matrices"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dynr_noise</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dynr/man/prep.noise.html" class="external-link">prep.noise</a></span><span class="op">(</span></span>
<span>  values.latent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/pkg/dynr/man/diag-character-method.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>    nrow <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span>,</span>
<span>  params.latent <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"sigma_1_1"</span>, <span class="st">"sigma_2_1"</span>, <span class="st">"sigma_3_1"</span>,</span>
<span>      <span class="st">"sigma_2_1"</span>, <span class="st">"sigma_2_2"</span>, <span class="st">"sigma_3_2"</span>,</span>
<span>      <span class="st">"sigma_3_1"</span>, <span class="st">"sigma_3_2"</span>, <span class="st">"sigma_3_3"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    nrow <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span>,</span>
<span>  values.observed <span class="op">=</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/pkg/dynr/man/diag-character-method.html" class="external-link">diag</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>,</span>
<span>  params.observed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="st">"theta_1_1"</span>, <span class="st">"fixed"</span>, <span class="st">"fixed"</span>,</span>
<span>      <span class="st">"fixed"</span>, <span class="st">"theta_2_2"</span>, <span class="st">"fixed"</span>,</span>
<span>      <span class="st">"fixed"</span>, <span class="st">"fixed"</span>, <span class="st">"theta_3_3"</span></span>
<span>    <span class="op">)</span>,</span>
<span>    nrow <span class="op">=</span> <span class="fl">3</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="prepare-the-model">Prepare the Model<a class="anchor" aria-label="anchor" href="#prepare-the-model"></a>
</h3>
<p>In this example, we increase the maximum evaluations in the
optimization process and constrain the lower and upper bounds of the
parameters for the drift matrix.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dynr_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dynr/man/dynr.model.html" class="external-link">dynr.model</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dynr_data</span>,</span>
<span>  initial <span class="op">=</span> <span class="va">dynr_initial</span>,</span>
<span>  measurement <span class="op">=</span> <span class="va">dynr_measurement</span>,</span>
<span>  dynamics <span class="op">=</span> <span class="va">dynr_dynamics</span>,</span>
<span>  noise <span class="op">=</span> <span class="va">dynr_noise</span>,</span>
<span>  outfile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>      <span class="st">"src-"</span>,</span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/format.html" class="external-link">format</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>        <span class="st">"%Y-%m-%d-%H-%M-%OS3"</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span>,</span>
<span>    fileext <span class="op">=</span> <span class="st">".c"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">dynr_model</span><span class="op">@</span><span class="va">options</span><span class="op">$</span><span class="va">maxeval</span> <span class="op">&lt;-</span> <span class="fl">100000</span></span>
<span><span class="va">lb</span> <span class="op">&lt;-</span> <span class="va">ub</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">dynr_model</span><span class="op">$</span><span class="va">xstart</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">ub</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">lb</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">dynr_model</span><span class="op">$</span><span class="va">xstart</span><span class="op">)</span></span>
<span><span class="va">lb</span><span class="op">[</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"phi_1_1"</span>, <span class="st">"phi_2_1"</span>, <span class="st">"phi_3_1"</span>,</span>
<span>    <span class="st">"phi_1_2"</span>, <span class="st">"phi_2_2"</span>, <span class="st">"phi_3_2"</span>,</span>
<span>    <span class="st">"phi_1_3"</span>, <span class="st">"phi_2_3"</span>, <span class="st">"phi_3_3"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1.5</span></span>
<span><span class="va">ub</span><span class="op">[</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"phi_1_1"</span>, <span class="st">"phi_2_1"</span>, <span class="st">"phi_3_1"</span>,</span>
<span>    <span class="st">"phi_1_2"</span>, <span class="st">"phi_2_2"</span>, <span class="st">"phi_3_2"</span>,</span>
<span>    <span class="st">"phi_1_3"</span>, <span class="st">"phi_2_3"</span>, <span class="st">"phi_3_3"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fl">1.5</span></span>
<span><span class="va">dynr_model</span><span class="op">$</span><span class="va">lb</span> <span class="op">&lt;-</span> <span class="va">lb</span></span>
<span><span class="va">dynr_model</span><span class="op">$</span><span class="va">ub</span> <span class="op">&lt;-</span> <span class="va">ub</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="fit-the-model">Fit the Model<a class="anchor" aria-label="anchor" href="#fit-the-model"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/dynr/man/dynr.cook.html" class="external-link">dynr.cook</a></span><span class="op">(</span></span>
<span>  <span class="va">dynr_model</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Get ready!!!!"</span></span>
<span><span class="co">#&gt; using C compiler: ‘gcc (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’</span></span>
<span><span class="co">#&gt; Optimization function called.</span></span>
<span><span class="co">#&gt; Starting Hessian calculation ...</span></span>
<span><span class="co">#&gt; Finished Hessian calculation.</span></span>
<span><span class="co">#&gt; Original exit flag:  3 </span></span>
<span><span class="co">#&gt; Modified exit flag:  3 </span></span>
<span><span class="co">#&gt; Optimization terminated successfully: ftol_rel or ftol_abs was reached. </span></span>
<span><span class="co">#&gt; Original fitted parameters:  -0.4698862 0.4809285 -0.271115 -0.1084163 </span></span>
<span><span class="co">#&gt; -0.2331007 0.57961 0.1213907 -0.07442704 -0.5738682 -1.201511 0.1658071 </span></span>
<span><span class="co">#&gt; -0.2466908 -3.284142 0.6538633 -2.921072 -1.613853 -1.554704 -1.653759 </span></span>
<span><span class="co">#&gt; -0.2189028 0.5735116 0.6406938 -2.712846 0.7234869 -5.739647 -1.131197 1.457115 </span></span>
<span><span class="co">#&gt; -3.579996 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Transformed fitted parameters:  -0.4698862 0.4809285 -0.271115 -0.1084163 </span></span>
<span><span class="co">#&gt; -0.2331007 0.57961 0.1213907 -0.07442704 -0.5738682 0.3007396 0.04986477 </span></span>
<span><span class="co">#&gt; -0.07418968 0.04574067 0.01220087 0.0881988 0.199119 0.211252 0.1913294 </span></span>
<span><span class="co">#&gt; -0.2189028 0.5735116 0.6406938 0.06634768 0.04800168 -0.3808122 0.3573753 </span></span>
<span><span class="co">#&gt; 0.1946208 2.898642 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Doing end processing</span></span>
<span><span class="co">#&gt; Warning in sqrt(diag(x$inv.hessian)): NaNs produced</span></span>
<span><span class="co">#&gt; Successful trial</span></span>
<span><span class="co">#&gt; Total Time: 42.0362 </span></span>
<span><span class="co">#&gt; Backend Time: 41.25672</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;              Estimate Std. Error t value   ci.lower   ci.upper Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; phi_1_1    -0.4698862  0.3734948  -1.258 -1.2019225  0.2621501   0.1045    </span></span>
<span><span class="co">#&gt; phi_2_1     0.4809285  0.1781928   2.699  0.1316771  0.8301800   0.0036 ** </span></span>
<span><span class="co">#&gt; phi_3_1    -0.2711150  0.2083709  -1.301 -0.6795145  0.1372845   0.0969 .  </span></span>
<span><span class="co">#&gt; phi_1_2    -0.1084163  0.2321649  -0.467 -0.5634512  0.3466185   0.3204    </span></span>
<span><span class="co">#&gt; phi_2_2    -0.2331007  0.1105811  -2.108 -0.4498357 -0.0163658   0.0178 *  </span></span>
<span><span class="co">#&gt; phi_3_2     0.5796100  0.1363571   4.251  0.3123549  0.8468651   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; phi_1_3     0.1213907  0.1565825   0.775 -0.1855054  0.4282868   0.2193    </span></span>
<span><span class="co">#&gt; phi_2_3    -0.0744270  0.0735117  -1.012 -0.2185074  0.0696533   0.1559    </span></span>
<span><span class="co">#&gt; phi_3_3    -0.5738682  0.0916326  -6.263 -0.7534648 -0.3942715   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; sigma_1_1   0.3007396  0.1122916   2.678  0.0806521  0.5208271   0.0038 ** </span></span>
<span><span class="co">#&gt; sigma_2_1   0.0498648  0.0401853   1.241 -0.0288969  0.1286265   0.1076    </span></span>
<span><span class="co">#&gt; sigma_3_1  -0.0741897  0.0428654  -1.731 -0.1582043  0.0098249   0.0421 *  </span></span>
<span><span class="co">#&gt; sigma_2_2   0.0457407  0.0234338   1.952 -0.0001887  0.0916700   0.0258 *  </span></span>
<span><span class="co">#&gt; sigma_3_2   0.0122009  0.0206733   0.590 -0.0283181  0.0527198   0.2777    </span></span>
<span><span class="co">#&gt; sigma_3_3   0.0881988  0.0337203   2.616  0.0221082  0.1542894   0.0046 ** </span></span>
<span><span class="co">#&gt; theta_1_1   0.1991190  0.0178903  11.130  0.1640546  0.2341833   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; theta_2_2   0.2112520  0.0148880  14.189  0.1820720  0.2404319   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; theta_3_3   0.1913294  0.0140468  13.621  0.1637981  0.2188606   &lt;2e-16 ***</span></span>
<span><span class="co">#&gt; mu0_1_1    -0.2189028  0.1678919  -1.304 -0.5479650  0.1101593   0.0965 .  </span></span>
<span><span class="co">#&gt; mu0_2_1     0.5735116  0.2813058   2.039  0.0221625  1.1248608   0.0210 *  </span></span>
<span><span class="co">#&gt; mu0_3_1     0.6406938  0.7675896   0.835 -0.8637542  2.1451418   0.2022    </span></span>
<span><span class="co">#&gt; sigma0_1_1  0.0663477  0.0789889   0.840 -0.0884677  0.2211631   0.2007    </span></span>
<span><span class="co">#&gt; sigma0_2_1  0.0480017  0.1080453   0.444 -0.1637632  0.2597665   0.3285    </span></span>
<span><span class="co">#&gt; sigma0_3_1 -0.3808122  0.3502062  -1.087 -1.0672038  0.3055793   0.1387    </span></span>
<span><span class="co">#&gt; sigma0_2_2  0.3573753  0.2484766   1.438 -0.1296299  0.8443804   0.0755 .  </span></span>
<span><span class="co">#&gt; sigma0_3_2  0.1946208  0.5038433   0.386 -0.7928940  1.1821355   0.3497    </span></span>
<span><span class="co">#&gt; sigma0_3_3  2.8986422  1.8778449   1.544 -0.7818662  6.5791505   0.0617 .  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; -2 log-likelihood value at convergence = 2176.87</span></span>
<span><span class="co">#&gt; AIC = 2230.87</span></span>
<span><span class="co">#&gt; BIC = 2344.67</span></span>
<span><span class="va">coefs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span>
<span><span class="va">vcovs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/vcov.html" class="external-link">vcov</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="extract-matrices-from-the-fitted-model-to-use-in-ctmed">Extract Matrices from the Fitted Model to use in cTMed<a class="anchor" aria-label="anchor" href="#extract-matrices-from-the-fitted-model-to-use-in-ctmed"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phi_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"phi_1_1"</span>, <span class="st">"phi_2_1"</span>, <span class="st">"phi_3_1"</span>,</span>
<span>  <span class="st">"phi_1_2"</span>, <span class="st">"phi_2_2"</span>, <span class="st">"phi_3_2"</span>,</span>
<span>  <span class="st">"phi_1_3"</span>, <span class="st">"phi_2_3"</span>, <span class="st">"phi_3_3"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">sigma_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"sigma_1_1"</span>, <span class="st">"sigma_2_1"</span>, <span class="st">"sigma_3_1"</span>,</span>
<span>  <span class="st">"sigma_2_1"</span>, <span class="st">"sigma_2_2"</span>, <span class="st">"sigma_3_2"</span>,</span>
<span>  <span class="st">"sigma_3_1"</span>, <span class="st">"sigma_3_2"</span>, <span class="st">"sigma_3_3"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">sigma_vech_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"sigma_1_1"</span>, <span class="st">"sigma_2_1"</span>, <span class="st">"sigma_3_1"</span>,</span>
<span>  <span class="st">"sigma_2_2"</span>, <span class="st">"sigma_3_2"</span>,</span>
<span>  <span class="st">"sigma_3_3"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">theta_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"phi_1_1"</span>, <span class="st">"phi_2_1"</span>, <span class="st">"phi_3_1"</span>,</span>
<span>  <span class="st">"phi_1_2"</span>, <span class="st">"phi_2_2"</span>, <span class="st">"phi_3_2"</span>,</span>
<span>  <span class="st">"phi_1_3"</span>, <span class="st">"phi_2_3"</span>, <span class="st">"phi_3_3"</span>,</span>
<span>  <span class="st">"sigma_1_1"</span>, <span class="st">"sigma_2_1"</span>, <span class="st">"sigma_3_1"</span>,</span>
<span>  <span class="st">"sigma_2_2"</span>, <span class="st">"sigma_3_2"</span>,</span>
<span>  <span class="st">"sigma_3_3"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">phi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">coefs</span><span class="op">[</span><span class="va">phi_names</span><span class="op">]</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  ncol <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span>
<span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">coefs</span><span class="op">[</span><span class="va">sigma_names</span><span class="op">]</span>,</span>
<span>  nrow <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  ncol <span class="op">=</span> <span class="fl">3</span></span>
<span><span class="op">)</span></span>
<span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="va">coefs</span><span class="op">[</span><span class="va">theta_names</span><span class="op">]</span></span>
<span><span class="va">vcov_phi_vec</span> <span class="op">&lt;-</span> <span class="va">vcovs</span><span class="op">[</span><span class="va">phi_names</span>, <span class="va">phi_names</span><span class="op">]</span></span>
<span><span class="va">vcov_sigma_vech</span> <span class="op">&lt;-</span> <span class="va">vcovs</span><span class="op">[</span><span class="va">sigma_vech_names</span>, <span class="va">sigma_vech_names</span><span class="op">]</span></span>
<span><span class="va">vcov_theta</span> <span class="op">&lt;-</span> <span class="va">vcovs</span><span class="op">[</span><span class="va">theta_names</span>, <span class="va">theta_names</span><span class="op">]</span></span></code></pre></div>
<div class="section level4">
<h4 id="estimated-drift-matrix-with-corresponding-sampling-covariance-matrix">Estimated Drift Matrix with Corresponding Sampling Covariance
Matrix<a class="anchor" aria-label="anchor" href="#estimated-drift-matrix-with-corresponding-sampling-covariance-matrix"></a>
</h4>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">phi</span></span>
<span><span class="co">#&gt;            [,1]       [,2]        [,3]</span></span>
<span><span class="co">#&gt; [1,] -0.4698862 -0.1084163  0.12139067</span></span>
<span><span class="co">#&gt; [2,]  0.4809285 -0.2331007 -0.07442704</span></span>
<span><span class="co">#&gt; [3,] -0.2711150  0.5796100 -0.57386817</span></span>
<span><span class="va">vcov_phi_vec</span></span>
<span><span class="co">#&gt;              phi_1_1      phi_2_1      phi_3_1      phi_1_2       phi_2_2</span></span>
<span><span class="co">#&gt; phi_1_1  0.139498354  0.016453186 -0.024616366 -0.063284419 -0.0071795100</span></span>
<span><span class="co">#&gt; phi_2_1  0.016453186  0.031752663  0.004331388 -0.004599403 -0.0144764610</span></span>
<span><span class="co">#&gt; phi_3_1 -0.024616366  0.004331388  0.043418436  0.011084687 -0.0014418349</span></span>
<span><span class="co">#&gt; phi_1_2 -0.063284419 -0.004599403  0.011084687  0.053900542  0.0055756970</span></span>
<span><span class="co">#&gt; phi_2_2 -0.007179510 -0.014476461 -0.001441835  0.005575697  0.0122281766</span></span>
<span><span class="co">#&gt; phi_3_2  0.012043087 -0.003370903 -0.020100519 -0.011139880  0.0020434715</span></span>
<span><span class="co">#&gt; phi_1_3  0.032644640  0.002446814 -0.004853325 -0.024077181 -0.0021870649</span></span>
<span><span class="co">#&gt; phi_2_3  0.003454896  0.006900240  0.000602233 -0.002161512 -0.0055253915</span></span>
<span><span class="co">#&gt; phi_3_3 -0.006194428  0.001486373  0.009105221  0.004841600 -0.0009803863</span></span>
<span><span class="co">#&gt;              phi_3_2      phi_1_3      phi_2_3       phi_3_3</span></span>
<span><span class="co">#&gt; phi_1_1  0.012043087  0.032644640  0.003454896 -0.0061944279</span></span>
<span><span class="co">#&gt; phi_2_1 -0.003370903  0.002446814  0.006900240  0.0014863728</span></span>
<span><span class="co">#&gt; phi_3_1 -0.020100519 -0.004853325  0.000602233  0.0091052214</span></span>
<span><span class="co">#&gt; phi_1_2 -0.011139880 -0.024077181 -0.002161512  0.0048416004</span></span>
<span><span class="co">#&gt; phi_2_2  0.002043471 -0.002187065 -0.005525391 -0.0009803863</span></span>
<span><span class="co">#&gt; phi_3_2  0.018593269  0.004392724 -0.000702762 -0.0078576176</span></span>
<span><span class="co">#&gt; phi_1_3  0.004392724  0.024518087  0.002745859 -0.0048524381</span></span>
<span><span class="co">#&gt; phi_2_3 -0.000702762  0.002745859  0.005403973  0.0007763040</span></span>
<span><span class="co">#&gt; phi_3_3 -0.007857618 -0.004852438  0.000776304  0.0083965366</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="process-noise-covariance-matrix-with-corresponding-sampling-covariance-matrix">Process Noise Covariance Matrix with Corresponding Sampling
Covariance Matrix<a class="anchor" aria-label="anchor" href="#process-noise-covariance-matrix-with-corresponding-sampling-covariance-matrix"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sigma</span></span>
<span><span class="co">#&gt;             [,1]       [,2]        [,3]</span></span>
<span><span class="co">#&gt; [1,]  0.30073959 0.04986477 -0.07418968</span></span>
<span><span class="co">#&gt; [2,]  0.04986477 0.04574067  0.01220087</span></span>
<span><span class="co">#&gt; [3,] -0.07418968 0.01220087  0.08819880</span></span>
<span><span class="va">vcov_sigma_vech</span></span>
<span><span class="co">#&gt;               sigma_1_1     sigma_2_1     sigma_3_1     sigma_2_2     sigma_3_2</span></span>
<span><span class="co">#&gt; sigma_1_1  0.0126094039  1.733365e-03 -1.719205e-03  3.377105e-04 -0.0002592661</span></span>
<span><span class="co">#&gt; sigma_2_1  0.0017333652  1.614857e-03  5.911297e-05  3.557050e-04 -0.0003118577</span></span>
<span><span class="co">#&gt; sigma_3_1 -0.0017192055  5.911297e-05  1.837442e-03  6.811970e-05  0.0001950196</span></span>
<span><span class="co">#&gt; sigma_2_2  0.0003377105  3.557050e-04  6.811970e-05  5.491411e-04  0.0001109005</span></span>
<span><span class="co">#&gt; sigma_3_2 -0.0002592661 -3.118577e-04  1.950196e-04  1.109005e-04  0.0004273852</span></span>
<span><span class="co">#&gt; sigma_3_3  0.0001654689  4.602159e-05 -6.454612e-04 -2.405006e-05  0.0001010033</span></span>
<span><span class="co">#&gt;               sigma_3_3</span></span>
<span><span class="co">#&gt; sigma_1_1  1.654689e-04</span></span>
<span><span class="co">#&gt; sigma_2_1  4.602159e-05</span></span>
<span><span class="co">#&gt; sigma_3_1 -6.454612e-04</span></span>
<span><span class="co">#&gt; sigma_2_2 -2.405006e-05</span></span>
<span><span class="co">#&gt; sigma_3_2  1.010033e-04</span></span>
<span><span class="co">#&gt; sigma_3_3  1.137059e-03</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="estimated-drift-matrix-and-process-noise-covariance-matrix-with-corresponding-sampling-covariance-matrix">Estimated Drift Matrix and Process Noise Covariance Matrix with
Corresponding Sampling Covariance Matrix<a class="anchor" aria-label="anchor" href="#estimated-drift-matrix-and-process-noise-covariance-matrix-with-corresponding-sampling-covariance-matrix"></a>
</h4>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">theta</span></span>
<span><span class="co">#&gt;     phi_1_1     phi_2_1     phi_3_1     phi_1_2     phi_2_2     phi_3_2 </span></span>
<span><span class="co">#&gt; -0.46988620  0.48092854 -0.27111500 -0.10841632 -0.23310072  0.57960998 </span></span>
<span><span class="co">#&gt;     phi_1_3     phi_2_3     phi_3_3   sigma_1_1   sigma_2_1   sigma_3_1 </span></span>
<span><span class="co">#&gt;  0.12139067 -0.07442704 -0.57386817  0.30073959  0.04986477 -0.07418968 </span></span>
<span><span class="co">#&gt;   sigma_2_2   sigma_3_2   sigma_3_3 </span></span>
<span><span class="co">#&gt;  0.04574067  0.01220087  0.08819880</span></span>
<span><span class="va">vcov_theta</span></span>
<span><span class="co">#&gt;                 phi_1_1       phi_2_1       phi_3_1       phi_1_2       phi_2_2</span></span>
<span><span class="co">#&gt; phi_1_1    0.1394983540  1.645319e-02 -0.0246163657 -6.328442e-02 -7.179510e-03</span></span>
<span><span class="co">#&gt; phi_2_1    0.0164531858  3.175266e-02  0.0043313880 -4.599403e-03 -1.447646e-02</span></span>
<span><span class="co">#&gt; phi_3_1   -0.0246163657  4.331388e-03  0.0434184364  1.108469e-02 -1.441835e-03</span></span>
<span><span class="co">#&gt; phi_1_2   -0.0632844191 -4.599403e-03  0.0110846872  5.390054e-02  5.575697e-03</span></span>
<span><span class="co">#&gt; phi_2_2   -0.0071795100 -1.447646e-02 -0.0014418349  5.575697e-03  1.222818e-02</span></span>
<span><span class="co">#&gt; phi_3_2    0.0120430874 -3.370903e-03 -0.0201005191 -1.113988e-02  2.043471e-03</span></span>
<span><span class="co">#&gt; phi_1_3    0.0326446404  2.446814e-03 -0.0048533249 -2.407718e-02 -2.187065e-03</span></span>
<span><span class="co">#&gt; phi_2_3    0.0034548964  6.900240e-03  0.0006022330 -2.161512e-03 -5.525391e-03</span></span>
<span><span class="co">#&gt; phi_3_3   -0.0061944279  1.486373e-03  0.0091052214  4.841600e-03 -9.803863e-04</span></span>
<span><span class="co">#&gt; sigma_1_1 -0.0324603860 -4.712194e-03  0.0049318085  1.190161e-02  1.522018e-03</span></span>
<span><span class="co">#&gt; sigma_2_1 -0.0033135484 -4.986362e-03 -0.0007496575 -3.465041e-05  1.585838e-03</span></span>
<span><span class="co">#&gt; sigma_3_1  0.0042219078 -9.597942e-05 -0.0056737761 -1.421460e-03  3.371015e-05</span></span>
<span><span class="co">#&gt; sigma_2_2 -0.0006494357 -4.670294e-04 -0.0002434917  1.207145e-05 -5.541605e-04</span></span>
<span><span class="co">#&gt; sigma_3_2  0.0004252891  1.205610e-03 -0.0001587289  7.777523e-05 -4.847930e-04</span></span>
<span><span class="co">#&gt; sigma_3_3 -0.0002729903 -4.073543e-04  0.0020819095 -4.428919e-05  3.215823e-04</span></span>
<span><span class="co">#&gt;                 phi_3_2       phi_1_3       phi_2_3       phi_3_3     sigma_1_1</span></span>
<span><span class="co">#&gt; phi_1_1    1.204309e-02  3.264464e-02  3.454896e-03 -6.194428e-03 -0.0324603860</span></span>
<span><span class="co">#&gt; phi_2_1   -3.370903e-03  2.446814e-03  6.900240e-03  1.486373e-03 -0.0047121937</span></span>
<span><span class="co">#&gt; phi_3_1   -2.010052e-02 -4.853325e-03  6.022330e-04  9.105221e-03  0.0049318085</span></span>
<span><span class="co">#&gt; phi_1_2   -1.113988e-02 -2.407718e-02 -2.161512e-03  4.841600e-03  0.0119016091</span></span>
<span><span class="co">#&gt; phi_2_2    2.043471e-03 -2.187065e-03 -5.525391e-03 -9.803863e-04  0.0015220179</span></span>
<span><span class="co">#&gt; phi_3_2    1.859327e-02  4.392724e-03 -7.027620e-04 -7.857618e-03 -0.0019077617</span></span>
<span><span class="co">#&gt; phi_1_3    4.392724e-03  2.451809e-02  2.745859e-03 -4.852438e-03 -0.0060687877</span></span>
<span><span class="co">#&gt; phi_2_3   -7.027620e-04  2.745859e-03  5.403973e-03  7.763040e-04 -0.0006938247</span></span>
<span><span class="co">#&gt; phi_3_3   -7.857618e-03 -4.852438e-03  7.763040e-04  8.396537e-03  0.0009761326</span></span>
<span><span class="co">#&gt; sigma_1_1 -1.907762e-03 -6.068788e-03 -6.938247e-04  9.761326e-04  0.0126094039</span></span>
<span><span class="co">#&gt; sigma_2_1  5.964116e-04 -3.016291e-04 -7.725899e-04 -1.940056e-04  0.0017333652</span></span>
<span><span class="co">#&gt; sigma_3_1  1.965159e-03 -1.047635e-05 -1.348959e-04 -7.048410e-04 -0.0017192055</span></span>
<span><span class="co">#&gt; sigma_2_2 -8.782099e-05 -8.073118e-05  1.512088e-04 -1.846845e-05  0.0003377105</span></span>
<span><span class="co">#&gt; sigma_3_2 -4.275267e-04 -7.941072e-05 -3.063590e-06  3.033239e-05 -0.0002592661</span></span>
<span><span class="co">#&gt; sigma_3_3 -4.958909e-04  1.857013e-04 -2.634748e-04 -4.230855e-04  0.0001654689</span></span>
<span><span class="co">#&gt;               sigma_2_1     sigma_3_1     sigma_2_2     sigma_3_2     sigma_3_3</span></span>
<span><span class="co">#&gt; phi_1_1   -3.313548e-03  4.221908e-03 -6.494357e-04  4.252891e-04 -2.729903e-04</span></span>
<span><span class="co">#&gt; phi_2_1   -4.986362e-03 -9.597942e-05 -4.670294e-04  1.205610e-03 -4.073543e-04</span></span>
<span><span class="co">#&gt; phi_3_1   -7.496575e-04 -5.673776e-03 -2.434917e-04 -1.587289e-04  2.081910e-03</span></span>
<span><span class="co">#&gt; phi_1_2   -3.465041e-05 -1.421460e-03  1.207145e-05  7.777523e-05 -4.428919e-05</span></span>
<span><span class="co">#&gt; phi_2_2    1.585838e-03  3.371015e-05 -5.541605e-04 -4.847930e-04  3.215823e-04</span></span>
<span><span class="co">#&gt; phi_3_2    5.964116e-04  1.965159e-03 -8.782099e-05 -4.275267e-04 -4.958909e-04</span></span>
<span><span class="co">#&gt; phi_1_3   -3.016291e-04 -1.047635e-05 -8.073118e-05 -7.941072e-05  1.857013e-04</span></span>
<span><span class="co">#&gt; phi_2_3   -7.725899e-04 -1.348959e-04  1.512088e-04 -3.063590e-06 -2.634748e-04</span></span>
<span><span class="co">#&gt; phi_3_3   -1.940056e-04 -7.048410e-04 -1.846845e-05  3.033239e-05 -4.230855e-04</span></span>
<span><span class="co">#&gt; sigma_1_1  1.733365e-03 -1.719205e-03  3.377105e-04 -2.592661e-04  1.654689e-04</span></span>
<span><span class="co">#&gt; sigma_2_1  1.614857e-03  5.911297e-05  3.557050e-04 -3.118577e-04  4.602159e-05</span></span>
<span><span class="co">#&gt; sigma_3_1  5.911297e-05  1.837442e-03  6.811970e-05  1.950196e-04 -6.454612e-04</span></span>
<span><span class="co">#&gt; sigma_2_2  3.557050e-04  6.811970e-05  5.491411e-04  1.109005e-04 -2.405006e-05</span></span>
<span><span class="co">#&gt; sigma_3_2 -3.118577e-04  1.950196e-04  1.109005e-04  4.273852e-04  1.010033e-04</span></span>
<span><span class="co">#&gt; sigma_3_3  4.602159e-05 -6.454612e-04 -2.405006e-05  1.010033e-04  1.137059e-03</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0" line-spacing="2">
<div id="ref-Ou-Hunter-Chow-2019" class="csl-entry">
Ou, L., Hunter, M. D., &amp; Chow, S.-M. (2019). What’s for <span class="nocase">dynr</span>: A package for linear and nonlinear dynamic
modeling in <span>R</span>. <em>The R Journal</em>, <em>11</em>(1), 91.
<a href="https://doi.org/10.32614/rj-2019-012" class="external-link">https://doi.org/10.32614/rj-2019-012</a>
</div>
<div id="ref-RCoreTeam-2024" class="csl-entry">
R Core Team. (2024). <em><span>R</span>: A language and environment for
statistical computing</em>. R Foundation for Statistical Computing. <a href="https://www.R-project.org/" class="external-link">https://www.R-project.org/</a>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ivan Jacob Agaloos Pesigan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
